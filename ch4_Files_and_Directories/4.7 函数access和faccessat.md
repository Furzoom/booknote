# 函数access和faccessat

使用open函数打开一个文件时，内核以进程有效用户ID和有效用户组ID为基础执行其访问权限测试。有时，进程也希望按其实际用户ID和实际组ID来测试其访问能力。access和faccessat函数是按实际用户ID和实际组ID进行访问权限测试的。

```c
#include <unistd.h>
int access(const char *pathname, int mode);
int faccessat(int fd, const char *pathname, int mode, int flag);
```

* 成功返回0，出错返回-1。
* 测试文件是否存在，mode参数为`F_OK`。否则mode使用如下常量的按位或。

mode | description
--- | ---
R_OK | 测试读权限
W_OK | 测试写权限
X_OK | 测试执行权限

faccessat函数和access函数在下面两种情况下是相同的：一种是pathname参数是绝对路径，另一种是fd参数取值为`AT_FDCWD`而pathname参数为相对路径。否则faccessat计算相对于fd的pathname。

flag参数可以用于改变faccessat的行为，如果flag设置为`AT_EACCESS`，访问检查用的是调用进程的有效用户ID和有效组ID，而不是实际用户ID和实际组ID。