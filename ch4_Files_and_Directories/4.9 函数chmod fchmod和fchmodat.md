# 函数chmod、fchmod和fchmodat

```c
#include <sys/stat.h>
int chmod(const char *pathname, mode_t mode);
int fchmod(int filedes, mode_t mode);
int fchmodat(int filedes, const char *pathname, mode_t mode, int flag);
```

* 成功返回0，出错返回-1。
* chmod函数在指定的文件上操作。
* fchmod函数对已打开的文件进行操作。
* 若pathname为绝对路径，或者filedes参数为`AT_FDCWD`且pathname为相对路径时，fchmodat与chmode相同。否则fchmodat根据filedes参数展开相对路径pathname参数。如果参数flat设置了`AT_SYMLINK_NOFOLLOW`，则只对符号链接本身进行设置。

若要改变一个文件的权限位，进程的有效用户ID必须等于文件的所有者ID，或者该进程必须具有超级用户权限。

mode参数：

mode | Description
--- | ---
S_ISUID | set-user-ID on execution
S_ISGID | set-group-ID on execution
S_ISVTX | saved-text(sticky bit)
S_IRUSR | -
S_IWUSR | -
S_IXUSR | -
S_IRGRP | -
S_IWGRP | -
S_IXGRP | -
S_IROTH | -
S_IWOTH | -
S_IXOTH | -

* 在Solaris等系统上对于普通文件设置`S_ISVTX`，而又没有超级用户权限，那么mode中的`S_ISVTX`将被自动关闭。
* 如果新文件的组ID不等于进程的有效组ID或者进程附加组ID中的一个，以及进程没有超级用户权限，设置组ID被自动关闭。
