# 函数rename和renameat

文件或者目录可以使用下面两个函数进行重命名。

```c
#include <stdio.h>
int rename(const char *oldname, const char *newname);
int renameat(int oldfd, const char *oldname, int newfd, const char *newname);
```

* 成功返回0，出错返回-1。
* 如果oldname指的是一个文件而不是目录，那么为该文件或符号链接重命名。此时，如果newname已存在，则它不能引用一个目录。如果newname已存在，而且不是一个目录，则先将该目录项删除然后将oldname重命名为newname。对包含oldname的目录和包含newname的目录，调用进程必须具有写权限。
* 如oldname指的是一个目录，那么为该目录重命名。如果newname已存在，则它必须引用一个目录，而且该目录应当是空目录。如果newname已存在，且是一个空目录，则先将其删除，然后将oldname重命名为newname。另外当为一个目录重命名时，newname不能包含oldname作为其路径前缀。
* 如oldname或newname引用符号链接，则处理的是符号链接本身，而不是它所引用的文件。
* 不能对`.`和`..`重命名。
* 如果newname和oldname引用同一个文件，则函数不做任何更改返回成功。

除了当oldname或newname指向相对路径名时，其他情况下rename和renameat功能相同。如果二者为相对路径名，则相对于对应的文件描述符进行计算路径。如果文件描述符设置为`AT_FDCWD`，则相对于进程的当前工作目录进行计算路径。