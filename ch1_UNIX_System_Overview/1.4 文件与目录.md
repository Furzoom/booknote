# 文件与目录

## 文件系统

UNIX文件系统是目录与文件组成的一种层次结构，目录的起点称为根(root)。其名字是`/`。目录是包含目录项的文件，目录项包含文件名和文件属性。文件属性指文件类型、文件大小、文件所有者、文件权限和修改时间等。

`stat`和`fstat`命令用于查看文件属性信息。

## 文件名

文件名(filename)，即目录项中的名字。不能出现在文件名中字符有`/`和空字符`null`。`/`用于分隔路径名，空字符用于终止路径名。

`.`与`..`为目录自动创建的2个目录名，前者指当前目录，后者指父目录。在根目录下两者相同。


## 路径名

以`/`开头的路径名(pathname)为绝对路径，否则为相对路径。

常用函数`opendir()`, `readdir()`, `closedir()`。

```c
#include <sys/types.h>
#include <dirent.h>
// open a directory
DIR *opendir(const char *dirname);
DIR *fdopendir(int fd);
```
* On error, NULL is returned.

```c
#include <sys/types.h>
#include <dirent.h>
// close a directory
int closedir(DIR *dirp);
```
* Return 0 on success. On error, -1 is returned.

```c
#include <dirent.h>
// read a directory
struct dirent *readdir(DIR *dirp);
int readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result);

struct dirent {
	ino_t			d_ino;			/* inode number */
	off_t			d_off;			/* offset to the next dirent */
	unsigned short	d_reclen;		/* length of this record */
	unsigned char 	d_type;			/* type of file */
	char 			d_name[256];	/* filename */
									/* only d_ino and d_name is standard. */
};
```
* Return NOT NULL on success. Return NULL and NOT set errno when reach end of directory stream. On error, NULL is returned and set errno.

## 工作目录

每个工作进程都有一个工作目录(working directory)。所有的相对路径名都是从当前工作目录开始解释的。`chdir()`可以更改工作目录。

```c
#include <unistd.h>
// change working directory
int chdir(const char *path);
int fchdir(int fd);
```

* On success, zero is returned. On error, -1 is returned, and errno is set.

## 起始目录

起始目录(home directory)在口令文件中指明。
