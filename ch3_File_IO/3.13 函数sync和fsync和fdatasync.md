# 函数sync、fsync和fdatasync

传统的UNIX实现在内核中设有缓冲区高速缓存或者页面缓存，多数的磁盘I/O都通过缓冲进行。当将数据写入文件时，内核通常先将该数据复制到其中一个缓冲区中，如果该缓冲区尚未写满，则并不将其排入输出队列，而是等待其写满或者当内核需要重用缓冲区时，再将其排入输出队列，然后待其到达队首时，才进行实际的I/O操作。这种方式称为延迟写(delayed write)。

```c
#include <unistd.h>
int fsync(int fd);
int fdatasync(int fd);
void sync(void);
```

* fsync和fdatasync成功返回0，出错返回-1。

sync函数只是将所有修改过的块缓冲排入写队列，然后就返回，它并不等待实际写磁盘操作结束。

fsync函数只对由文件描述符fd指定的单一文件起作用，并且等待写磁盘操盘结束，然后返回。会同步更新文件属性。

fdatasync函数类似于fsync，但它只影响文件的数据部分。
