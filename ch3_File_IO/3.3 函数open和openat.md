# 函数open和openat

```c
#include <fcntl.h>
int open(const char *path, int oflag, .../*mode_t mode */);
int openat(int fd, const char *path, int oflat, .../*mode_t mode */);
```

* path是要打开或者创建的文件的名字。
* oflag参数用来说明此函数的多个选项。 
	* `O_RDONLY` 只读打开。
	* `O_WRONLY` 只写打开。
	* `O_RDWR` 读写打开。
	* `O_EXEC` 只执行打开。
	* `O_SEARCH` 只搜索打开(应用于目录)。(操作系统对其支持有限)。
	* **以上5个选项必须且只能指定一个**。
	* `O_APPEND` 每次写都追加到文件的尾端。
	* `O_CLOEXEC` 设置文件描述符标志`FD_CLOEXEC`。
	* `O_CREAT` 若文件不存在，则创建它。需要指定mode参数，表示访问权限。
	* `O_DIRECTORY` 如果path引用的不是目录，则出错。
	* `O_EXCL` 如果同时指定了`O_CREAT`，而文件存在，则出错。如果不存在，则创建文件。
	* `O_NOCTTY` 如果path引用的是终端设备，则不将该设备分配为此进程的控制终端。
	* `O_NOFOLLOW` 如果path引用的是一个符号链接，则出错。
	* `O_NONBLOCK` 如果path引用的是一个FIFO、一个块特殊文件或者一个字符特殊文件，则将本次打开及后续的I/O操作设置非阻塞方式。
	* `O_TRUNC` 如果此文件存在，且为只写或者读写打开，则将其长度截断为0。
	* `O_TTY_INIT` 如果打开一个还未打开的终端设备，设置非标准termios参数值，使其符合Single UNIX Specification。
	* `O_SYNC` 使每次write等待物理I/O操作完成，包括由该write操作引起的文件属性更新所需要的I/O。
	* `O_DSYNC` 使每次write要等待物理I/O操作完成，但是如果该写操作并不影响读取刚写入的数据，则不需等待文件属性被更新。
	* `O_RSYNC` 使每一个以文件描述符作为参数进行的read操作等待，直至所有对文件同一部分挂起的写操作都完成。
* 若成功返回文件描述符，若出错，则返回-1。


这两个函数都返回未使用的文件描述符的最小值。

open与openat函数区别：
* path参数指定的是绝对路径名，fd参数被忽略，openat函数相当于open函数。
* path参数指定的是相对路径名，fd参数指出了相对路径名在文件系统中的开始地址。
* path参数指定了相对路径名，fd参数具有特殊值AT_FDCWD。路径名在当前工作目录中获取。
